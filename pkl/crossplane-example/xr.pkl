amends "@crossplane/CrossplaneResource.pkl"
import "@crossplane/CompositionRequest.pkl"
import "crds/XR.pkl"
import "crds/Object.pkl"
import "@k8s/api/core/v1/ConfigMap.pkl"

local state = import("crossplane:state") as CompositionRequest
local observedCompositeResource: XR = state.observed.composite.resource as XR

local obj: Object? = state.observed.resources.getOrNull("cm-one")?.resource as Object?
local cmOne: Dynamic? = obj?.status?.atProvider?.manifest
local cmOneNs = cmOne?.getPropertyOrNull("metadata")?.getPropertyOrNull("namespace")

resource = (observedCompositeResource) {
  status {
    when (cmOneNs != null) {
      someStatus = "I observed cm-one's namespace. it is \(cmOneNs)"
    }
  }
}
connectionDetails {
  ["test"] = "bar"
}
