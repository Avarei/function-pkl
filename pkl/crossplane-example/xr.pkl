amends "@crossplane/Resource.pkl"
import "@crossplane/CompositionRequest.pkl"
import "crds/XR.pkl"
import "crds/Object.pkl"
import "@k8s/api/core/v1/ConfigMap.pkl"

local request = import("crossplane:request") as CompositionRequest
local observedCompositeResource: XR = request.observed.composite.resource as XR

local obj: Object? = request.observed.resources.getOrNull("cm-one")?.resource as Object?
local cmOne: Dynamic? = obj?.status?.atProvider?.manifest

resource = (observedCompositeResource) {
  status {
    when (cmOne != null) {
      someStatus = "I observed cm-one's namespace. it is \(cmOne["metadata"]["namespace"])"
    }
  }
}
connectionDetails {
  ["test"] = "bar"
}
